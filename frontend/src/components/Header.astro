---
import { getCollection } from "astro:content";

const services = await getCollection("services");
const navItems = [
  { title: "Home", path: "/" },
  {
    title: "Services",
    path: "/services",
    dropdown: services.map((service) => ({
      title: service.data.serviceName,
      path: `/services/${service.slug}`,
    })),
  },
  { title: "Service Areas", path: "/service-areas" },
  { title: "About", path: "/about" },
  { title: "Blog", path: "/blog" },
  { title: "Contact", path: "/contact" },
];
---

<header class="fixed w-full bg-white shadow-md z-50">
  <div class="container mx-auto">
    <!-- Top Bar -->
    <div
      class="flex justify-end items-center py-1 px-6 border-b border-gray-100"
    >
      <div class="flex items-center gap-6 text-sm">
        <div class="flex items-center gap-2">
          <svg
            class="w-4 h-4 text-primary"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
            ></path>
          </svg>
          <span>Adelaide, South Australia</span>
        </div>
        <a
          href="tel:0812345678"
          class="flex items-center gap-2 text-primary hover:text-primary-light transition-colors"
        >
          <svg
            class="w-4 h-4"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
            ></path>
          </svg>
          <span>08 1234 5678</span>
        </a>
      </div>
    </div>

    <!-- Main Navigation -->
    <nav class="flex justify-between items-center px-6 py-3">
      <!-- Logo -->
      <a href="/" class="text-lg font-bold text-primary whitespace-nowrap">
        Foundation Repair<span class="text-secondary">Adelaide</span>
      </a>

      <!-- Navigation Items -->
      <div class="hidden lg:flex items-center">
        {
          navItems.map((item) => (
            <div class="relative group px-3">
              {item.dropdown ? (
                <>
                  <button class="flex items-center gap-1 text-neutral hover:text-primary transition-colors py-2">
                    {item.title}
                    <svg
                      class="w-4 h-4 ml-1"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M19 9l-7 7-7-7"
                      />
                    </svg>
                  </button>
                  <div class="absolute left-0 top-full bg-white shadow-lg rounded-md py-2 w-64 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300">
                    {item.dropdown.map((subItem) => (
                      <a
                        href={subItem.path}
                        class="block px-4 py-2 text-neutral hover:bg-neutral-light hover:text-primary transition-colors"
                      >
                        {subItem.title}
                      </a>
                    ))}
                  </div>
                </>
              ) : (
                <a
                  href={item.path}
                  class="text-neutral hover:text-primary transition-colors py-2"
                >
                  {item.title}
                </a>
              )}
            </div>
          ))
        }

        <!-- CTA Button -->
        <a
          href="/contact"
          class="ml-4 bg-[#B91C1C] hover:bg-[#991B1B] text-white px-5 py-2 rounded-sm text-sm font-semibold transition-colors duration-300"
        >
          GET A FREE ESTIMATE
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button
        class="lg:hidden text-neutral hover:text-primary p-2"
        onclick="document.getElementById('mobile-menu').classList.toggle('hidden')"
      >
        <svg
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="lg:hidden hidden">
      <div class="px-4 py-2 space-y-1 border-t border-gray-100">
        {
          navItems.map((item) => (
            <div class="py-1">
              {item.dropdown ? (
                <div>
                  <button
                    class="w-full flex items-center justify-between px-4 py-2 text-neutral hover:text-primary transition-colors"
                    onclick={`this.nextElementSibling.classList.toggle('hidden')`}
                  >
                    {item.title}
                    <svg
                      class="w-4 h-4"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M19 9l-7 7-7-7"
                      />
                    </svg>
                  </button>
                  <div class="hidden pl-4">
                    {item.dropdown.map((subItem) => (
                      <a
                        href={subItem.path}
                        class="block px-4 py-2 text-neutral hover:text-primary transition-colors"
                      >
                        {subItem.title}
                      </a>
                    ))}
                  </div>
                </div>
              ) : (
                <a
                  href={item.path}
                  class="block px-4 py-2 text-neutral hover:text-primary transition-colors"
                >
                  {item.title}
                </a>
              )}
            </div>
          ))
        }
        <div class="py-4">
          <a
            href="/contact"
            class="block w-full bg-[#B91C1C] hover:bg-[#991B1B] text-white text-center px-5 py-2 rounded-sm text-sm font-semibold transition-colors duration-300"
          >
            GET A FREE ESTIMATE
          </a>
        </div>
      </div>
    </div>
  </div>
</header>
